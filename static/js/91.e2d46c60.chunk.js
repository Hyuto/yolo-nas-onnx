(self.webpackChunkyolo_nas_web=self.webpackChunkyolo_nas_web||[]).push([[91],{1:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var a=n(4165),r=n(5861),s=n(885),o=n(2791),i=n(3863),c=n.n(i),l=n(4996),u=n(5221),d=n(2982),f=n(3144),h=n(5671),p=JSON.parse('["person","bicycle","car","motorcycle","airplane","bus","train","truck","boat","traffic light","fire hydrant","stop sign","parking meter","bench","bird","cat","dog","horse","sheep","cow","elephant","bear","zebra","giraffe","backpack","umbrella","handbag","tie","suitcase","frisbee","skis","snowboard","sports ball","kite","baseball bat","baseball glove","skateboard","surfboard","tennis racket","bottle","wine glass","cup","fork","knife","spoon","bowl","banana","apple","sandwich","orange","broccoli","carrot","hot dog","pizza","donut","cake","chair","couch","potted plant","bed","dining table","toilet","tv","laptop","mouse","remote","keyboard","cell phone","microwave","oven","toaster","sink","refrigerator","book","clock","vase","scissors","teddy bear","hair drier","toothbrush"]'),b=function(e,t){var n=e.getContext("2d");n.clearRect(0,0,n.canvas.width,n.canvas.height);var a=new x,r="".concat(Math.max(Math.round(Math.max(n.canvas.width,n.canvas.height)/40),14),"px Arial");n.font=r,n.textBaseline="top",t.forEach((function(e){var t=p[e.label],o=a.get(e.label),i=(100*e.probability).toFixed(1),c=(0,s.Z)(e.bounding,4),l=c[0],u=c[1],d=c[2],f=c[3];n.fillStyle=x.hexToRgba(o,.2),n.fillRect(l,u,d,f),n.strokeStyle=o,n.lineWidth=Math.max(Math.min(n.canvas.width,n.canvas.height)/200,2.5),n.strokeRect(l,u,d,f),n.fillStyle=o;var h=n.measureText(t+" - "+i+"%").width,b=parseInt(r,10),g=u-(b+n.lineWidth);n.fillRect(l-1,g<0?0:g,h+n.lineWidth,b+n.lineWidth),n.fillStyle="#ffffff",n.fillText(t+" - "+i+"%",l-1,g<0?1:g+1)}))},x=(0,f.Z)((function e(){var t=this;(0,h.Z)(this,e),this.get=function(e){return t.palette[Math.floor(e)%t.n]},this.palette=["#FF3838","#FF9D97","#FF701F","#FFB21D","#CFD231","#48F90A","#92CC17","#3DDB86","#1A9334","#00D4BB","#2C99A8","#00C2FF","#344593","#6473FF","#0018EC","#8438FF","#520085","#CB38FF","#FF95C8","#FF37C7"],this.n=this.palette.length}));x.hexToRgba=function(e,t){var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?"rgba(".concat([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)].join(", "),", ").concat(t,")"):null};var g=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,n,r,o,i,c,u){var f,h,p,x,g,m,w,k,y,F,j,C,R,O,S,Z,L,T,M,A,N,B,_,D,I,U;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=u.slice(2),h=(0,s.Z)(f,2),p=h[0],x=h[1],g=v(t,p,x),m=(0,s.Z)(g,3),w=m[0],k=m[1],y=m[2],F=new l.Tensor("float32",w.data32F,u),j=new l.Tensor("float32",new Float32Array([o,i,c])),C=r.net.outputNames,e.next=7,r.net.run({"input.1":F});case 7:return R=e.sent,e.next=10,r.nms.run({bboxes:R[C[0]],scores:R[C[1]],config:j});case 10:for(O=e.sent,S=O.selected,Z=[],L=0;L<S.dims[1];L++)T=S.data.slice(L*S.dims[2],(L+1)*S.dims[2]),M=T.slice(0,4),A=T.slice(4),N=Math.max.apply(Math,(0,d.Z)(A)),B=A.indexOf(N),_=M[0]*k,D=M[1]*y,I=(M[2]-M[0])*k,U=(M[3]-M[1])*y,Z.push({label:B,probability:N,bounding:[_,D,I,U]});b(n,Z),w.delete();case 16:case"end":return e.stop()}}),e)})));return function(t,n,a,r,s,o,i){return e.apply(this,arguments)}}(),v=function(e,t,n){var a=c().imread(e),r=new(c().Mat)(a.rows,a.cols,c().CV_8UC3);c().cvtColor(a,r,c().COLOR_RGBA2BGR);var s=Math.max(r.rows,r.cols),o=s-r.cols,i=s/r.cols,l=s-r.rows,u=s/r.rows,d=new(c().Mat);c().copyMakeBorder(r,d,0,l,0,o,c().BORDER_CONSTANT);var f=c().blobFromImage(d,1/255,new(c().Size)(t,n),new(c().Scalar)(0,0,0),!0,!1);return a.delete(),r.delete(),d.delete(),[f,i,u]},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(n,a){var r=new XMLHttpRequest;if(r.open("GET",e,!0),r.responseType="arraybuffer",t){var o=(0,s.Z)(t,2),i=o[0],c=o[1];r.onprogress=function(e){var t=e.loaded/e.total*100;c({text:i,progress:t.toFixed(2)})}}r.onload=function(){this.status>=200&&this.status<300?n(r.response):a({status:this.status,statusText:r.statusText}),n(r.response)},r.onerror=function(){a({status:this.status,statusText:r.statusText})},r.send()}))},w=n(184),k=function(){var e=(0,o.useState)(null),t=(0,s.Z)(e,2),n=t[0],i=t[1],d=(0,o.useState)({text:"Loading OpenCV.js",progress:null}),f=(0,s.Z)(d,2),h=f[0],p=f[1],b=(0,o.useState)(null),x=(0,s.Z)(b,2),v=x[0],k=x[1],y=(0,o.useRef)(null),F=(0,o.useRef)(null),j=(0,o.useRef)(null),C="yolo_nas_s.onnx",R=[1,3,640,640];return c().onRuntimeInitialized=(0,r.Z)((0,a.Z)().mark((function e(){var t,n,r,s,o,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("/yolo-nas-onnx","/model"),e.next=3,m("".concat(t,"/").concat(C),["Loading YOLO-NAS model",p]);case 3:return n=e.sent,e.next=6,l.InferenceSession.create(n);case 6:return r=e.sent,e.next=9,m("".concat(t,"/nms-yolo-nas.onnx"),["Loading NMS model",p]);case 9:return s=e.sent,e.next=12,l.InferenceSession.create(s);case 12:return o=e.sent,p({text:"Warming up model...",progress:null}),c=new l.Tensor("float32",new Float32Array(R.reduce((function(e,t){return e*t}))),R),e.next=17,r.run({"input.1":c});case 17:i({net:r,nms:o}),p(null);case 19:case"end":return e.stop()}}),e)}))),(0,w.jsxs)("div",{className:"App",children:[h&&(0,w.jsx)(u.Z,{children:h.progress?"".concat(h.text," - ").concat(h.progress,"%"):h.text}),(0,w.jsxs)("div",{className:"header",children:[(0,w.jsx)("h1",{children:"YOLO-NAS Object Detection App"}),(0,w.jsxs)("p",{children:["YOLO-NAS object detection application live on browser powered by"," ",(0,w.jsx)("strong",{children:"onnxruntime-web"})]}),(0,w.jsxs)("p",{children:["Serving : ",(0,w.jsx)("code",{children:C})]})]}),(0,w.jsxs)("div",{className:"content",children:[(0,w.jsx)("img",{ref:F,src:"#",alt:"",style:{display:v?"block":"none"},onLoad:function(){g(F.current,j.current,n,100,.45,.2,R)}}),(0,w.jsx)("canvas",{id:"canvas",width:R[2],height:R[3],ref:j})]}),(0,w.jsx)("input",{type:"file",ref:y,accept:"image/*",style:{display:"none"},onChange:function(e){v&&(URL.revokeObjectURL(v),k(null));var t=URL.createObjectURL(e.target.files[0]);F.current.src=t,k(t)}}),(0,w.jsxs)("div",{className:"btn-container",children:[(0,w.jsx)("button",{onClick:function(){y.current.click()},children:"Open local image"}),v&&(0,w.jsx)("button",{onClick:function(){y.current.value="",F.current.src="#",URL.revokeObjectURL(v),k(null)},children:"Close image"})]})]})}},4619:function(){},3004:function(){},7897:function(){}}]);
//# sourceMappingURL=91.e2d46c60.chunk.js.map